# AUTOGENERATED! DO NOT EDIT! File to edit: nbs/utils/utils.pooling.ipynb (unless otherwise specified).

__all__ = ['kmax_pooling', 'avg_pooling']

# Cell
def kmax_pooling(x, dim, k):
    index = x.topk(k, dim=dim)[1].sort(dim=dim)[0]
    return x.gather(dim, index).squeeze(dim)

# Cell
def avg_pooling(x, dim):
    return x.sum(dim=dim)/x.size(dim)