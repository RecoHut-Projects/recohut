---

title: CTR Dataset


keywords: fastai
sidebar: home_sidebar

summary: "Implementation of base modules for ctr dataset."
description: "Implementation of base modules for ctr dataset."
nb_path: "nbs/datasets/bases/datasets.bases.ctr.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/datasets/bases/datasets.bases.ctr.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CTRDataset" class="doc_header"><code>class</code> <code>CTRDataset</code><a href="https://github.com/RecoHut-Projects/recohut/tree/master/recohut/datasets/bases/ctr.py#L30" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CTRDataset</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwds</code></strong>) :: <a href="/recohut/datasets.base.html#Dataset"><code>Dataset</code></a></p>
</blockquote>
<p>An abstract class representing a :class:<a href="/recohut/datasets.base.html#Dataset"><code>Dataset</code></a>.</p>
<p>All datasets that represent a map from keys to data samples should subclass
it. All subclasses should overwrite :meth:<code>__getitem__</code>, supporting fetching a
data sample for a given key. Subclasses could also optionally overwrite
:meth:<code>__len__</code>, which is expected to return the size of the dataset by many
:class:<code>~torch.utils.data.Sampler</code> implementations and the default options
of :class:<code>~torch.utils.data.DataLoader</code>.</p>
<p>.. note::
  :class:<code>~torch.utils.data.DataLoader</code> by default constructs a index
  sampler that yields integral indices.  To make it work with a map-style
  dataset with non-integral indices/keys, a custom sampler must be provided.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CTRDataModule" class="doc_header"><code>class</code> <code>CTRDataModule</code><a href="https://github.com/RecoHut-Projects/recohut/tree/master/recohut/datasets/bases/ctr.py#L313" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CTRDataModule</code>(<strong>*<code>args</code></strong>:<code>Any</code>, <strong>**<code>kwargs</code></strong>:<code>Any</code>) :: <code>LightningDataModule</code></p>
</blockquote>
<p>A DataModule standardizes the training, val, test splits, data preparation and transforms. The main
advantage is consistent data splits, data preparation and transforms across models.</p>
<p>Example::</p>

<pre><code>class MyDataModule(LightningDataModule):
    def __init__(self):
        super().__init__()
    def prepare_data(self):
        # download, split, etc...
        # only called on 1 GPU/TPU in distributed
    def setup(self, stage):
        # make assignments here (val/train/test split)
        # called on every process in DDP
    def train_dataloader(self):
        train_split = Dataset(...)
        return DataLoader(train_split)
    def val_dataloader(self):
        val_split = Dataset(...)
        return DataLoader(val_split)
    def test_dataloader(self):
        test_split = Dataset(...)
        return DataLoader(test_split)
    def teardown(self):
        # clean up after fit or test
        # called on every process in DDP

</code></pre>
<p>A DataModule implements 6 key methods:</p>
<ul>
<li><strong>prepare_data</strong> (things to do on 1 GPU/TPU not on every GPU/TPU in distributed mode).</li>
<li><strong>setup</strong>  (things to do on every accelerator in distributed mode).</li>
<li><strong>train_dataloader</strong> the training dataloader.</li>
<li><strong>val_dataloader</strong> the val dataloader(s).</li>
<li><strong>test_dataloader</strong> the test dataloader(s).</li>
<li><strong>teardown</strong> (things to do on every accelerator in distributed mode when finished)</li>
</ul>
<p>This allows you to share a full dataset without explaining how to download, split, transform, and process the data</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Tokenizer" class="doc_header"><code>class</code> <code>Tokenizer</code><a href="https://github.com/RecoHut-Projects/recohut/tree/master/recohut/datasets/bases/ctr.py#L384" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Tokenizer</code>(<strong><code>topk_words</code></strong>=<em><code>None</code></em>, <strong><code>na_value</code></strong>=<em><code>None</code></em>, <strong><code>min_freq</code></strong>=<em><code>1</code></em>, <strong><code>splitter</code></strong>=<em><code>None</code></em>, <strong><code>lower</code></strong>=<em><code>False</code></em>, <strong><code>oov_token</code></strong>=<em><code>0</code></em>, <strong><code>max_len</code></strong>=<em><code>0</code></em>, <strong><code>padding_type</code></strong>=<em><code>'pre'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Normalizer" class="doc_header"><code>class</code> <code>Normalizer</code><a href="https://github.com/RecoHut-Projects/recohut/tree/master/recohut/datasets/bases/ctr.py#L479" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Normalizer</code>(<strong><code>normalizer</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FeatureMap" class="doc_header"><code>class</code> <code>FeatureMap</code><a href="https://github.com/RecoHut-Projects/recohut/tree/master/recohut/datasets/bases/ctr.py#L504" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FeatureMap</code>(<strong><code>dataset_id</code></strong>=<em><code>'ctr'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Example</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TaobaoDataset</span><span class="p">(</span><span class="n">CTRDataset</span><span class="p">):</span>

    <span class="n">feature_cols</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;userid&quot;</span><span class="p">,</span><span class="s2">&quot;adgroup_id&quot;</span><span class="p">,</span><span class="s2">&quot;pid&quot;</span><span class="p">,</span><span class="s2">&quot;cate_id&quot;</span><span class="p">,</span><span class="s2">&quot;campaign_id&quot;</span><span class="p">,</span><span class="s2">&quot;customer&quot;</span><span class="p">,</span><span class="s2">&quot;brand&quot;</span><span class="p">,</span><span class="s2">&quot;cms_segid&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;cms_group_id&quot;</span><span class="p">,</span><span class="s2">&quot;final_gender_code&quot;</span><span class="p">,</span><span class="s2">&quot;age_level&quot;</span><span class="p">,</span><span class="s2">&quot;pvalue_level&quot;</span><span class="p">,</span><span class="s2">&quot;shopping_level&quot;</span><span class="p">,</span><span class="s2">&quot;occupation&quot;</span><span class="p">],</span>
                        <span class="s1">&#39;active&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;categorical&#39;</span><span class="p">}]</span>
                        
    <span class="n">label_col</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;clk&#39;</span><span class="p">,</span> <span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">}</span>

    <span class="n">train_url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/RecoHut-Datasets/sample_ctr/raw/v1/train_sample.csv&quot;</span>
    <span class="n">valid_url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/RecoHut-Datasets/sample_ctr/raw/v1/valid_sample.csv&quot;</span>
    <span class="n">test_url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/RecoHut-Datasets/sample_ctr/raw/v1/test_sample.csv&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">raw_file_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;train_sample.csv&#39;</span><span class="p">,</span>
                <span class="s1">&#39;valid_sample.csv&#39;</span><span class="p">,</span>
                <span class="s1">&#39;test_sample.csv&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">download_url</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train_url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_dir</span><span class="p">)</span>
        <span class="n">download_url</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valid_url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_dir</span><span class="p">)</span>
        <span class="n">download_url</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test_url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_dir</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">convert_hour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">col_name</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;time_stamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">ts</span><span class="p">:</span> <span class="n">ts</span><span class="p">[</span><span class="mi">11</span><span class="p">:</span><span class="mi">13</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">convert_weekday</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">col_name</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">_convert_weekday</span><span class="p">(</span><span class="n">timestamp</span><span class="p">):</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">date</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">timestamp</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">timestamp</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">timestamp</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">10</span><span class="p">]))</span>
            <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%w&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;time_stamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">_convert_weekday</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">convert_weekend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">col_name</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">_convert_weekend</span><span class="p">(</span><span class="n">timestamp</span><span class="p">):</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">date</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">timestamp</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">timestamp</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">timestamp</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">10</span><span class="p">]))</span>
            <span class="k">return</span> <span class="s1">&#39;1&#39;</span> <span class="k">if</span> <span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%w&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;0&#39;</span>
        <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;time_stamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">_convert_weekend</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TaobaoDataModule</span><span class="p">(</span><span class="n">CTRDataModule</span><span class="p">):</span>
    <span class="n">dataset_cls</span> <span class="o">=</span> <span class="n">TaobaoDataset</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;model_id&#39;</span><span class="p">:</span> <span class="s1">&#39;DCN_demo&#39;</span><span class="p">,</span>
          <span class="s1">&#39;data_dir&#39;</span><span class="p">:</span> <span class="s1">&#39;/content/data&#39;</span><span class="p">,</span>
          <span class="s1">&#39;model_root&#39;</span><span class="p">:</span> <span class="s1">&#39;./checkpoints/&#39;</span><span class="p">,</span>
          <span class="s1">&#39;dnn_hidden_units&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">],</span>
          <span class="s1">&#39;dnn_activations&#39;</span><span class="p">:</span> <span class="s2">&quot;relu&quot;</span><span class="p">,</span>
          <span class="s1">&#39;crossing_layers&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
          <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">1e-3</span><span class="p">,</span>
          <span class="s1">&#39;net_dropout&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s1">&#39;batch_norm&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
          <span class="s1">&#39;optimizer&#39;</span><span class="p">:</span> <span class="s1">&#39;adamw&#39;</span><span class="p">,</span>
          <span class="s1">&#39;task&#39;</span><span class="p">:</span> <span class="s1">&#39;binary_classification&#39;</span><span class="p">,</span>
          <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="s1">&#39;binary_crossentropy&#39;</span><span class="p">,</span>
          <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;logloss&#39;</span><span class="p">,</span> <span class="s1">&#39;AUC&#39;</span><span class="p">],</span>
          <span class="s1">&#39;embedding_dim&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
          <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span>
          <span class="s1">&#39;epochs&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
          <span class="s1">&#39;shuffle&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
          <span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="mi">2019</span><span class="p">,</span>
          <span class="s1">&#39;use_hdf5&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
          <span class="s1">&#39;workers&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="s1">&#39;verbose&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">TaobaoDataModule</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">ds</span><span class="o">.</span><span class="n">prepare_data</span><span class="p">()</span>
<span class="n">ds</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>

<span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">train_dataloader</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
    <span class="k">break</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/pytorch_lightning/core/datamodule.py:74: LightningDeprecationWarning: DataModule property `train_transforms` was deprecated in v1.5 and will be removed in v1.7.
  &#34;DataModule property `train_transforms` was deprecated in v1.5 and will be removed in v1.7.&#34;
Downloading https://github.com/RecoHut-Datasets/sample_ctr/raw/v1/train_sample.csv
Downloading https://github.com/RecoHut-Datasets/sample_ctr/raw/v1/valid_sample.csv
Downloading https://github.com/RecoHut-Datasets/sample_ctr/raw/v1/test_sample.csv
Processing...
Done!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[tensor([[ 9., 30.,  1., 24., 30., 30., 24.,  2.,  1.,  1.,  1.,  1.,  1.,  1.],
        [ 7., 22.,  2., 12., 22., 22.,  0.,  4.,  3.,  1.,  4.,  1.,  1.,  1.],
        [20., 96.,  1., 18., 94., 93., 63.,  9.,  9.,  2.,  2.,  2.,  1.,  1.],
        [15., 45.,  2., 15., 44., 44.,  0.,  6.,  7.,  1.,  5.,  1.,  1.,  1.],
        [11., 32.,  2., 25., 32., 32., 26.,  2.,  1.,  1.,  1.,  1.,  1.,  1.],
        [ 2.,  8.,  1., 14.,  9., 10., 14.,  1.,  2.,  1.,  2.,  0.,  1.,  1.],
        [ 5., 43.,  1.,  1., 42., 42., 35.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
        [ 1.,  2.,  1.,  8.,  4.,  5.,  9.,  1.,  1.,  1.,  1.,  0.,  1.,  1.],
        [18., 78.,  1., 43., 76., 75.,  0.,  1.,  1.,  1.,  1.,  0.,  1.,  1.],
        [ 3., 92.,  1.,  1., 90., 89.,  0.,  1.,  4.,  1.,  3.,  0.,  1.,  1.],
        [15., 59.,  2., 10., 57., 57., 44.,  6.,  7.,  1.,  5.,  1.,  1.,  1.],
        [ 5., 52.,  1.,  1., 51., 51.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
        [17., 90.,  1., 19., 88., 87., 60.,  7.,  3.,  1.,  4.,  2.,  2.,  1.],
        [ 8., 21.,  2.,  1., 21., 21., 18.,  2.,  1.,  1.,  1.,  1.,  1.,  1.],
        [11., 58.,  2.,  1., 56., 56., 43.,  2.,  1.,  1.,  1.,  1.,  1.,  1.],
        [14., 49.,  1., 35., 48., 48., 38.,  1.,  3.,  1.,  4.,  0.,  3.,  1.],
        [19., 71.,  1., 39., 69., 68., 52.,  8.,  1.,  1.,  1.,  2.,  1.,  2.],
        [ 3., 97.,  1.,  5., 95., 94., 64.,  1.,  4.,  1.,  3.,  0.,  1.,  1.],
        [ 4., 80.,  2., 44., 78., 77.,  4.,  3.,  2.,  1.,  2.,  1.,  1.,  1.],
        [ 4., 99.,  2., 10., 97., 96.,  8.,  3.,  2.,  1.,  2.,  1.,  1.,  1.],
        [ 8.,  9.,  2.,  1., 10., 11.,  2.,  2.,  1.,  1.,  1.,  1.,  1.,  1.],
        [21., 11.,  2.,  3., 12., 13.,  0.,  1.,  7.,  1.,  5.,  0.,  1.,  1.],
        [24., 68.,  1., 37., 66., 65., 50.,  1.,  4.,  1.,  3.,  0.,  2.,  1.],
        [ 6., 51.,  1.,  2., 50., 50., 40.,  1.,  6.,  2.,  1.,  0.,  1.,  1.],
        [10., 31.,  2.,  3., 31., 31., 25.,  1.,  1.,  1.,  1.,  0.,  1.,  1.],
        [17.,  1.,  1.,  4.,  3.,  4.,  5.,  7.,  3.,  1.,  4.,  2.,  2.,  1.],
        [ 4., 89.,  2., 11., 87., 86.,  8.,  3.,  2.,  1.,  2.,  1.,  1.,  1.],
        [13., 60.,  1.,  2., 58., 58., 45.,  1.,  5.,  2.,  3.,  0.,  3.,  1.],
        [12., 46.,  1.,  5., 45., 45.,  0.,  5.,  8.,  2.,  5.,  1.,  1.,  1.],
        [12., 56.,  1.,  5., 54., 54.,  0.,  5.,  8.,  2.,  5.,  1.,  1.,  1.],
        [ 8., 13.,  2.,  1., 14.,  2.,  3.,  2.,  1.,  1.,  1.,  1.,  1.,  1.],
        [ 9., 54.,  1.,  3., 52., 52.,  4.,  2.,  1.,  1.,  1.,  1.,  1.,  1.],
        [12., 38.,  1., 28., 37., 37., 30.,  5.,  8.,  2.,  5.,  1.,  1.,  1.],
        [ 2., 17.,  1.,  2., 17., 17., 16.,  1.,  2.,  1.,  2.,  0.,  1.,  1.],
        [16., 79.,  1.,  4., 77., 76.,  0.,  1.,  5.,  2.,  3.,  0.,  2.,  1.],
        [18., 70.,  1., 38., 68., 67., 51.,  1.,  1.,  1.,  1.,  0.,  1.,  1.],
        [21.,  4.,  2., 20.,  5.,  6., 10.,  1.,  7.,  1.,  5.,  0.,  1.,  1.],
        [ 3., 88.,  1.,  6., 86., 85.,  0.,  1.,  4.,  1.,  3.,  0.,  1.,  1.],
        [ 5., 53.,  1.,  7.,  2.,  3.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
        [ 6., 57.,  1.,  2., 55., 55., 42.,  1.,  6.,  2.,  1.,  0.,  1.,  1.],
        [ 4., 86.,  2., 47., 84., 83.,  0.,  3.,  2.,  1.,  2.,  1.,  1.,  1.],
        [ 6., 48.,  1., 34., 47., 47., 37.,  1.,  6.,  2.,  1.,  0.,  1.,  1.],
        [ 5., 61.,  1.,  1., 59., 59.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
        [ 3., 63.,  1.,  1., 61.,  2.,  3.,  1.,  4.,  1.,  3.,  0.,  1.,  1.],
        [22., 93.,  2., 16., 91., 90., 61.,  4.,  3.,  1.,  4.,  1.,  1.,  1.],
        [ 3., 64.,  1.,  1., 62., 61., 47.,  1.,  4.,  1.,  3.,  0.,  1.,  1.],
        [14., 40.,  1., 30., 39., 39., 32.,  1.,  3.,  1.,  4.,  0.,  3.,  1.],
        [10., 34.,  2., 27., 34., 34.,  2.,  1.,  1.,  1.,  1.,  0.,  1.,  1.],
        [ 2., 24.,  1.,  3., 24., 24., 20.,  1.,  2.,  1.,  2.,  0.,  1.,  1.],
        [16.,  1.,  1.,  4.,  3.,  4.,  5.,  1.,  5.,  2.,  3.,  0.,  2.,  1.],
        [ 4., 67.,  2., 17., 65., 64.,  0.,  3.,  2.,  1.,  2.,  1.,  1.,  1.],
        [20., 75.,  1., 42., 73., 72.,  7.,  9.,  9.,  2.,  2.,  2.,  1.,  1.],
        [ 3., 84.,  1., 45., 82., 81., 57.,  1.,  4.,  1.,  3.,  0.,  1.,  1.],
        [ 3., 81.,  1.,  6., 79., 78.,  0.,  1.,  4.,  1.,  3.,  0.,  1.,  1.],
        [10., 42.,  2., 31., 41., 41., 34.,  1.,  1.,  1.,  1.,  0.,  1.,  1.],
        [ 3., 77.,  1.,  1., 75., 74., 55.,  1.,  4.,  1.,  3.,  0.,  1.,  1.],
        [ 2., 15.,  1.,  1.,  1.,  1.,  1.,  1.,  2.,  1.,  2.,  0.,  1.,  1.],
        [ 2., 28.,  1.,  6., 28., 28.,  0.,  1.,  2.,  1.,  2.,  0.,  1.,  1.],
        [ 5., 36.,  1.,  7., 35., 35., 28.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
        [ 4., 65.,  2., 11., 63., 62., 48.,  3.,  2.,  1.,  2.,  1.,  1.,  1.],
        [ 2., 25.,  1.,  1., 25., 25., 21.,  1.,  2.,  1.,  2.,  0.,  1.,  1.],
        [ 4., 87.,  2., 11., 85., 84., 59.,  3.,  2.,  1.,  2.,  1.,  1.,  1.],
        [15., 55.,  2., 10., 53., 53., 41.,  6.,  7.,  1.,  5.,  1.,  1.,  1.],
        [17., 98.,  1., 19., 96., 95., 65.,  7.,  3.,  1.,  4.,  2.,  2.,  1.]],
       dtype=torch.float64), tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 1., 0., 0.], dtype=torch.float64)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p><strong>References</strong></p>
<ul>
<li>FuxiCTR Project, <a href="https://github.com/xue-pai/FuxiCTR">https://github.com/xue-pai/FuxiCTR</a>.</li>
</ul>
</blockquote>

</div>
</div>
</div>
</div>
 

